<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui" />
	<link rel="shortcut icon" type="image/x-icon" href="/assets/common/favicon.ico" />
	<link rel="shortcut icon" type="image/png" href="/assets/common/favicon.png" />
	<link rel="apple-touch-icon" href="/assets/common/favicon.png" />

	<title>div 浮层遮盖 flash 问题再研究 - 任平生的学习笔记</title>
	<meta name="description" content="div 浮层遮挡 Flash 的研究汗牛充栋，随便 Google 一下都能找到浩如烟海的资料，最简单的解决方案就是使用 wmode=opaque 或者 wmode=transparent，如此的简单而又一劳永逸。" />
	<meta name="keyword"  content="flash, wmode, opaque, transparent, 任平生, 互联网, 前端, rpsh" />

	<meta http-equiv="Content-Security-Policy" content="frame-src 'self' disqus.com *.google.com zhannei.baidu.com jsfiddle.net caniuse.com codepen.io *.github.io; script-src 'self' *.google-analytics.com *.google.com *.googleapis.com cdn.bootcss.com disqus.com *.disqus.com *.disquscdn.com zhannei.baidu.com 'unsafe-inline' 'unsafe-eval'">
	
	<link rel="author" href="https://plus.google.com/100791036880126418228/posts" />
	
	<link rel="canonical" href="http://localhost:4000/posts/2014/04/30/div-flash/" />

	<!-- Bootstrap Core CSS -->
	<link rel="stylesheet" href="/css/bootstrap.min.css" />

	<!-- Custom CSS -->
	<link rel="stylesheet" href="/css/blog.css" />

	<!-- Pygments Github CSS -->
	<link rel="stylesheet" href="/css/syntax.css" />

	<!-- Custom Fonts -->
	<link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js" /></script>
		<script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js" /></script>
	<![endif]-->

	<!-- og/twitter/wechat meta -->
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@rpsh" />
	<meta name="twitter:url" property="og:url" content="http://localhost:4000/posts/2014/04/30/div-flash/" />
	<meta name="twitter:title" property="og:title" itemprop="name" content="div 浮层遮盖 flash 问题再研究 - 任平生的学习笔记" />
	<meta name="twitter:description" property="og:description" itemprop="description" content="div 浮层遮挡 Flash 的研究汗牛充栋，随便 Google 一下都能找到浩如烟海的资料，最简单的解决方案就是使用 wmode=opaque 或者 wmode=transparent，如此的简单而又一劳永逸。" />
	<meta name="twitter:image" property="og:image" itemprop="image" content="http://localhost:4000/assets/common/flash-thumb.jpg" />

	<meta name="wxm:timeline_title" content="div 浮层遮盖 flash 问题再研究 - 任平生的学习笔记" />
	<meta name="wxm:appmessage_title" content="div 浮层遮盖 flash 问题再研究 - 任平生的学习笔记" />
	<meta name="wxm:appmessage_desc" content="div 浮层遮挡 Flash 的研究汗牛充栋，随便 Google 一下都能找到浩如烟海的资料，最简单的解决方案就是使用 wmode=opaque 或者 wmode=transparent，如此的简单而又一劳永逸。" />
	<meta name="wxm:img_url" content="http://localhost:4000/assets/common/flash-thumb.jpg" />
	<meta name="wxm:link" content="http://localhost:4000/posts/2014/04/30/div-flash/" />
	
	<!-- header banner -->
	<style type="text/css">
		header.intro-header{
			background-image: url('/assets/common/flash-bg.jpg')
		}
		@media (max-width:767px){
			header.intro-header{
				background-image: url('/assets/common/flash-thumb.jpg');
			}
			/*header.intro-header:before{
				background-image: url('/assets/common/flash-thumb.jpg');
			}*/
		}
	</style>
	<!-- ga & ba script hoook -->
	<script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">任平生的学习笔记</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="navbar-site">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/" rel="bookmark">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/" rel="bookmark">About</a>
                    </li>
                    
                    <li>
                        <a href="/search/" rel="bookmark">Search</a>
                    </li>
                    
                    <li>
                        <a href="/tags/" rel="bookmark">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#navbar-site');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/assets/common/flash-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->
<header class="intro-header" >
	<div class="container">
		<div class="row">
			<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
				<div class="post-heading" itemscope itemtype="http://schema.org/NewsArticle">
					<div class="tags">
						
						<a class="tag" href="/tags/#Flash" rel="tag" title="Flash">Flash</a>
						
						<a class="tag" href="/tags/#HTML" rel="tag" title="HTML">HTML</a>
						
						<a class="tag" href="/tags/#Video" rel="tag" title="Video">Video</a>
						
					</div>
					<h1 itemprop="headline">div 浮层遮盖 flash 问题再研究</h1>
					<h2 class="subheading"></h2>
					
					<span class="meta">Posted by 任平生 on April 30, 2014</span>
					<meta itemprop="alternativeHeadline" content="div 浮层遮挡 Flash 的研究汗牛充栋，随便 Google 一下都能找到浩如烟海的资料，最简单的解决方案就是使用 wmode=opaque 或者 wmode=transparent，如此的简单而又一劳永逸。" />
					<meta itemprop="image" content="http://localhost:4000/assets/common/flash-thumb.jpg" />
					<meta itemprop="datePublished" content="2014-04-30 08:07:00 +0800" />
				</div>
			</div>
		</div>
	</div>
</header>

<!-- Post Content -->
<article>
	<div class="container">
		<div class="row">

	<!-- Post Container -->
			<div class="
				col-lg-8 col-lg-offset-2
				col-md-10 col-md-offset-1
				post-container">

				<p>div 浮层遮挡 Flash 的研究汗牛充栋，随便 Google 一下都能找到浩如烟海的资料，最简单的解决方案就是使用 <code class="highlighter-rouge">wmode="opaque"</code> 或者 <code class="highlighter-rouge">wmode="transparent"</code>，如此的简单而又一劳永逸。</p>

<p>没有特殊需求的到这里就可以止步了，但是 <code class="highlighter-rouge">wmode="opaque"</code> 并不适合所有网站，比如视频网站，<strong>视频网站对 Flash 的表现性能有着极致的追求</strong>，让我们更倾向选择使用 <code class="highlighter-rouge">wmode="window"</code>，现在有了更好的 <code class="highlighter-rouge">wmode="driect"</code> 模式。而在 window/driect 的模式下，普通的 div 浮层很难完美地实现遮挡 Flash 的需求。</p>

<h2 id="wmode-的五种取值">Wmode 的五种取值</h2>
<p>首先，我们了解一下 wmode 五种不同取值的<a href="http://blog.loveisanan.com/?p=117">含义</a>：</p>

<h4 id="window模式">Window模式</h4>

<p>默认情况下的显示模式，在这种模式下 flash player 有自己的窗口句柄，这就意味着 flash 影片是存在于 Windows 中的一个显示实例，并且是在浏览器核心显示窗口之上的，所以 flash 只是貌似显示在浏览器中，但这也是 flash 最快最有效率的渲染模式。由于他是独立于浏览器的HTML渲染表面，这就导致默认显示方式下flash总是会遮住位置与他重合的所有 HTML 层。</p>

<h4 id="opaque模式">Opaque模式</h4>

<p>这是一种无窗口模式，在这种情况下flash player没有自己的窗口句柄，这就需要浏览器需要告诉flash player在浏览器的渲染表面绘制的时间和位置。这时flash影片就不会在高于浏览器HTML渲染表面而是与其他元素一样在同一个页面上，因此你就可以使用 <code class="highlighter-rouge">z-index</code> 值来控制 HTML 元素是遮盖 flash 或者被遮盖。</p>

<h4 id="transparent模式">Transparent模式</h4>

<p>透明模式，在这种模式下 flash player 会将 stage 的背景色 alpha 值降为 0 并且只会绘制 stage 上真实可见的对象，同样你也可以使用 <code class="highlighter-rouge">z-index</code> 来控制 flash 影片的层级值，但是与 Opaque 模式不同的是这样做会降低 flash 影片的回放效果，而且在 9.0.115 之前的 flash player 版本设置 <code class="highlighter-rouge">wmode="opaque"</code> 或 <code class="highlighter-rouge">"transparent"</code> 会导致全屏模式失效。</p>

<h4 id="direct模式">Direct模式</h4>

<p>直接渲染模式，在该模式下，flash player 可以通过硬件直接对画面进行合成，并呈现在屏幕上。使用这种模式能够得到比 window 模式更好的渲染效果，特别是在视频播放方面，如果页面的 flash 需要使用了 stagevideo 或者 stage3D，那么必须使用这种模式。它有比 window 模式更好的渲染，但也有 window 模式下的所有缺点。</p>

<h4 id="gpu模式">GPU模式</h4>

<p>在一些网络电视和移动设备上可以启用额外的硬件加速，与其他 wmode 值模式相比，显示序列的像素保真度无法保证，其他方面跟 direct 模式相似。</p>

<h2 id="各家视频网站的-wmode-取值">各家视频网站的 wmode 取值</h2>

<table>
<thead><tr>
<th>Youku</th>
<th>Tudou</th>
<th>Tencent Video</th>
<th>iQiyi</th>
<th>Sohu TV</th>
<th>Letv</th>
<th>Sina Video</th>
<th>Youtube</th>
<th>Vimeo</th>
<th>Hulu</th>
<th>Flickr Video</th>
</tr></thead>
<tbody><tr>
<td>N/A</td>
<td>window/opaque</td>
<td>direct</td>
<td>window</td>
<td>opaque</td>
<td>opaque</td>
<td>transparent</td>
<td>N/A</td>
<td>opaque</td>
<td>N/A</td>
<td>opaque</td>
</tr></tbody>
</table>

<p>N/A 表示没有设置 wmode 值，此时 Flash 默认使用 window 的取值。
土豆在 XP 下的 IE 和 Chrome 使用了 opaque，其他情况下是 window。</p>

<p>有40.9%的视频网站采用了 window 的模式；还有 40.9% 的选择使用 opaque。 window 和 opaque 平分秋色，这样看来 opaque 也应该是一个不错的选择。（不知是这些网站的前端偷懒，还是性能上真的OK。这个稍后需要做一个性能测试后再分享相关数据）</p>

<h2 id="div-遮盖-flash-的测试结果">div 遮盖 Flash 的测试结果</h2>

<p>接下来我们来测试不同的 div 浮层遮挡不同 wmode 取值的 flash 的效果，下边是测试结果一览表：</p>

<table>
<thead><tr>
<th>wmode=window</th>
<th style="text-align: center">Windows</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">Mac</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td style="text-align: center">IE6-IE10</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
</tr>
<tr>
<td>div</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba)</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba) + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
</tbody>
</table>

<table>
<thead><tr>
<th>wmode=direct</th>
<th style="text-align: center">Windows</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">Mac</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td style="text-align: center">IE6-IE10</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
</tr>
<tr>
<td>div</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba)</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba) + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
</tbody>
</table>

<table>
<thead><tr>
<th>wmode=gpu</th>
<th style="text-align: center">Windows</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">Mac</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td style="text-align: center">IE6-IE10</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
</tr>
<tr>
<td>div</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba)</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba) + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✗</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
</tbody>
</table>

<table>
<thead><tr>
<th>wmode=opaque</th>
<th style="text-align: center">Windows</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">Mac</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td style="text-align: center">IE6-IE10</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
</tr>
<tr>
<td>div</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba)</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba) + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
</tbody>
</table>

<table>
<thead><tr>
<th>wmode=transparent</th>
<th style="text-align: center">Windows</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">Mac</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td style="text-align: center">IE6-IE10</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
</tr>
<tr>
<td>div</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba)</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba) + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
</tbody>
</table>

<p>注：div(rgba) 指定义浮层背景半透明色的情况，CSS 代码： <code class="highlighter-rouge">background-color:rgba(255,255,255,0.6)</code></p>

<h3 id="div-遮盖-flash-的测试结论">div 遮盖 Flash 的测试结论</h3>

<ol>
  <li>使用 opaque/transparent 模式，只需 div 就可以遮挡住 Flash；</li>
  <li>使用 window/direct/gpu 模式：
    <ol>
      <li>IE 需要借助 iframe 才能遮挡 Flash</li>
      <li>Chrome 仅 div 即可遮挡 Flash</li>
      <li>Firefox 当使用 rgba 的半透明背景色浮层时，无法遮挡 Flash</li>
      <li>Windows Safari 即使 iframe 也无法遮挡 Flash</li>
      <li>Mac 系统下 wmode 取任何值， div 元素都能轻松遮挡 Flash 元素</li>
    </ol>
  </li>
</ol>

<h4 id="特例1-windows-版的-firefox">特例1： Windows 版的 Firefox</h4>

<p>只有具有背景色(<code class="highlighter-rouge">background-color:#fff</code>)的元素才能遮挡 Flash，透明背景(<code class="highlighter-rouge">background:transparent</code>)，或者背景颜色为半透明(<code class="highlighter-rouge">background-color:rgba(255,255,255,0.5)</code>)，或者使用半透明图片(<code class="highlighter-rouge">background:url(alpha.png)</code>)做背景的元素都无法遮挡 Flash</p>

<h4 id="特例2-windows-版的-safari">特例2： Windows 版的 Safari</h4>

<p>上述 2.4 的结论有点让人沮丧，虽然 Windows 版 Safari 的份额处于异常边缘的位置，不过遇到这个问题还是解决，我们的解决方案是，当出现需要遮盖 Falsh 的浮层时候，暂时隐藏 Flash ，隐藏一个层通常有三种方式：</p>

<ol>
  <li><code class="highlighter-rouge">visibility:hidden;</code></li>
  <li><code class="highlighter-rouge">display:none;</code></li>
  <li><code class="highlighter-rouge">positiona:relative;left:-1000px;</code></li>
</ol>

<p>这里我们需要的隐藏应当达到如下效果：视频暂时不可见，浮层关闭后，Flash 视频应当继续播放。</p>

<p>以下是在 Windows 版各个浏览器中的测试结果</p>

<table>
<thead><tr>
<th style="text-align: left"></th>
<th style="text-align: left">IE6-IE10</th>
<th style="text-align: left">Chrome</th>
<th style="text-align: left">Firefox</th>
<th style="text-align: left">Safari</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left"><code>visibility:hidden</code></td>
<td style="text-align: left">A</td>
<td style="text-align: left">A</td>
<td style="text-align: left">A</td>
<td style="text-align: left">A</td>
</tr>
<tr>
<td style="text-align: left"><code>display:none</code></td>
<td style="text-align: left">A</td>
<td style="text-align: left">B</td>
<td style="text-align: left">B</td>
<td style="text-align: left">B</td>
</tr>
<tr>
<td style="text-align: left"><code>left:-1000px</code></td>
<td style="text-align: left">A</td>
<td style="text-align: left">A</td>
<td style="text-align: left">A</td>
<td style="text-align: left">A</td>
</tr>
</tbody>
</table>

<p>注1：</p>

<ul>
  <li>A: 视频隐藏，继续后台播放，切换回来后可继续正常播放</li>
  <li>B: 视频隐藏，停止播放，切换回来后从头重新开始播放</li>
</ul>

<p>注2： </p>

<ol>
  <li>wmode 的五种取值下 Flash 隐藏再显示的均表现一致；</li>
  <li>IE gpu 模式，<code class="highlighter-rouge">visibility:hidden</code> 的隐藏模式，会使视频回放1秒；</li>
</ol>

<h4 id="隐藏视频的结论">隐藏视频的结论：</h4>

<ol>
  <li><code class="highlighter-rouge">visibility:hidden</code> 和 <code class="highlighter-rouge">left:-1000px</code> 的方式，IE6-10、Firefox、Chrome、Safari 浏览器中 Flash 的隐藏与显示都不影响其正常播放（若想隐藏 Flash 时暂停视频的播放，可以调用 Flash 相应的 js 方法实现）；</li>
  <li><code class="highlighter-rouge">display:none</code> ，会导致视频在 Chrome、Firefox、Safari 中视频重新加载，从头开始播放；</li>
</ol>

<p>这里建议使用 <code class="highlighter-rouge">visibility:hidden</code> 的方法来隐藏视频，兼容性和对页面重绘的影响都最小。</p>

<h2 id="div-遮挡-html5-视频研究">div 遮挡 HTML5 视频研究</h2>
<p>说完 Flash 了，我们顺道研究一下 div 浮层遮挡 HTML5 Video 是否会有问题。经测试，结果如下表：</p>

<table>
<thead><tr>
<th>HTML5 Video</th>
<th style="text-align: center">Windows</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">Mac</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center">iOS</th>
<th style="text-align: center"></th>
<th style="text-align: center">Android</th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td style="text-align: center">IE9-IE10</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">Firefox</td>
<td style="text-align: center">Safari</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">原生</td>
<td style="text-align: center">Chrome</td>
<td style="text-align: center">UC</td>
</tr>
<tr>
<td>div</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba)</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td>div(rgba) + iframe</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
</tbody>
</table>

<p>注： iPhone 上当视频播放时会自动切换为全屏，此时没有任何页面元素可以遮挡它。当视频处于非全屏的暂停（或未开始播放）状态时， div 浮层可以遮挡 <code class="highlighter-rouge">&lt;video&gt;</code> 元素。iPad 上无此问题。</p>

<p>HTML5 Video 的得天独厚的优势 —— 无插件的视频播放，使其跟页面其他元素处于一种平等的层级关系上，div 浮层轻轻松松即可实现遮挡 <code class="highlighter-rouge">&lt;video&gt;</code> 内容。</p>

<h2 id="div-浮层遮挡-flash-的最终结论">div 浮层遮挡 Flash 的最终结论</h2>
<p><strong>对于 Flash</strong>
Windows 系统下：
如果可以使用 <code class="highlighter-rouge">wmode="opaque"</code> 或者 <code class="highlighter-rouge">wmode="transparent"</code> ， div 浮层遮挡 Flash， 只需设置好 div 浮层的 <code class="highlighter-rouge">z-index</code> 即可。</p>

<p>如果必须使用 <code class="highlighter-rouge">wmode="window"</code> 或者 <code class="highlighter-rouge">wmode="driect"</code> ，兼容各个浏览器的 div 浮层遮挡 Flash 的方案是使用 div + iframe 方式，而如果实现半透明的浮层效果（包括：背景色使用rgba，背景图带有透明的 png、gif 等），则要对 Firefox 进行特殊处理，单独定义 Firefox 使用纯色的背景。</p>

<pre><code class="language-CSS">/* Fierfox hack 参考 */
@-moz-document url-prefix(){
	.div_layer { 
		background-color: #fff;
		border-radius: 0; /* 遮挡Flash的浮层若设置圆角，在 Firefox 上会出现缺角的bug，需重置为0 */
	}
}
</code></pre>

<p>若还需要兼容 Windows 版的 Safari，则需要在遮挡 Flash 的浮层出现时，隐藏掉 Flash，隐藏 Flash 的方法推荐使用 <code class="highlighter-rouge">visibility:hidden</code></p>

<p>Mac 系统下：
无需担心 div 浮层的遮挡关系， 只需设置好 <code class="highlighter-rouge">z-index</code> 即可。</p>

<p><strong>对于 HTML5 <code class="highlighter-rouge">&lt;video&gt;</code> 元素</strong>
无论 Windows、Mac、iOS 还是 Android，普通的 div 元素都能轻松遮挡 <code class="highlighter-rouge">&lt;video&gt;</code> 元素。无需其他特殊处理。</p>



				

				<hr>

<<<<<<< HEAD
				
=======
<!-- AddToAny BEGIN -->
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
    <a class="a2a_button_sina_weibo"></a>
    <a class="a2a_button_wechat"></a>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_copy_link"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->
>>>>>>> origin/master


<<<<<<< HEAD
				<ul class="pager">
					
					<li class="previous">
						<a href="/posts/2014/04/15/weixin-webview-clear-cache/" title="微信 webview 清理缓存方法" rel="bookmark">&larr; 微信 webview 清理缓存方法</a>
					</li>
					
					
					<li class="next">
						<a href="/posts/2014/07/31/get-apache-working-on-osx-10-10-yosemite/" title="解决升级 Yosemite 后， Web Server 不工作的问题" rel="bookmark">解决升级 Yosemite 后， Web Server 不工作的问题 &rarr;</a>
					</li>
					
				</ul>


				
				<!-- 评论框 start -->
				<div class="post-comment">
					<div id="disqus_thread" class="disqus-thread"
						data-thread-key="/posts/2014/04/30/div-flash"
						data-title="div 浮层遮盖 flash 问题再研究"
						data-url="http://localhost:4000/posts/2014/04/30/div-flash/" >
					</div>
				</div>
				<!-- 评论框 end -->
				

			</div>


		</div>
	</div>
</article>

<aside class="post-side">
	<div class="container">
		<div class="row">
			<!-- Sidebar Container -->
			<div class="
				col-lg-8 col-lg-offset-2
				col-md-10 col-md-offset-1
				sidebar-container">

				<!-- Featured Tags -->
				
				<section>
					<hr class="hidden-sm hidden-xs">
					<h5><a href="/tags/" rel="tag">FEATURED TAGS</a></h5>
					<div class="tags">
						
							
								<a href="/tags/#CSS3" title="CSS3" rel="tag" date-size="5">
									CSS3
								</a>
							
						
							
								<a href="/tags/#CSS" title="CSS" rel="tag" date-size="15">
									CSS
								</a>
							
						
							
						
							
						
							
						
							
								<a href="/tags/#JS" title="JS" rel="tag" date-size="8">
									JS
								</a>
							
						
							
								<a href="/tags/#IE" title="IE" rel="tag" date-size="7">
									IE
								</a>
							
						
							
								<a href="/tags/#浏览器" title="浏览器" rel="tag" date-size="3">
									浏览器
								</a>
							
						
							
								<a href="/tags/#渲染模式" title="渲染模式" rel="tag" date-size="4">
									渲染模式
								</a>
							
						
							
								<a href="/tags/#Chrome" title="Chrome" rel="tag" date-size="5">
									Chrome
								</a>
							
						
							
						
							
						
							
								<a href="/tags/#HTML" title="HTML" rel="tag" date-size="5">
									HTML
								</a>
							
						
							
						
							
						
							
						
							
								<a href="/tags/#HTML5" title="HTML5" rel="tag" date-size="3">
									HTML5
								</a>
							
						
							
								<a href="/tags/#趣识" title="趣识" rel="tag" date-size="4">
									趣识
								</a>
							
						
							
						
							
						
							
						
							
								<a href="/tags/#CSS/font-family" title="CSS/font-family" rel="tag" date-size="2">
									CSS/font-family
								</a>
							
						
							
						
							
						
							
						
							
								<a href="/tags/#Apache" title="Apache" rel="tag" date-size="4">
									Apache
								</a>
							
						
							
						
							
						
							
						
							
								<a href="/tags/#Google" title="Google" rel="tag" date-size="2">
									Google
								</a>
							
						
							
						
							
						
							
						
							
								<a href="/tags/#OSX" title="OSX" rel="tag" date-size="5">
									OSX
								</a>
							
						
							
								<a href="/tags/#PHP" title="PHP" rel="tag" date-size="3">
									PHP
								</a>
							
						
							
						
							
								<a href="/tags/#iOS" title="iOS" rel="tag" date-size="3">
									iOS
								</a>
							
						
							
						
							
								<a href="/tags/#微信" title="微信" rel="tag" date-size="2">
									微信
								</a>
							
						
							
								<a href="/tags/#移动开发" title="移动开发" rel="tag" date-size="2">
									移动开发
								</a>
							
						
							
						
							
						
							
								<a href="/tags/#Yosemite" title="Yosemite" rel="tag" date-size="2">
									Yosemite
								</a>
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
								<a href="/tags/#iPhone" title="iPhone" rel="tag" date-size="4">
									iPhone
								</a>
							
						
							
						
							
								<a href="/tags/#iTunes" title="iTunes" rel="tag" date-size="2">
									iTunes
								</a>
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
								<a href="/tags/#Mac" title="Mac" rel="tag" date-size="2">
									Mac
								</a>
							
						
							
						
							
						
							
						
							
						
							
						
							
								<a href="/tags/#design" title="design" rel="tag" date-size="5">
									design
								</a>
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
								<a href="/tags/#development" title="development" rel="tag" date-size="3">
									development
								</a>
							
						
							
								<a href="/tags/#数据可视化" title="数据可视化" rel="tag" date-size="2">
									数据可视化
								</a>
							
						
							
								<a href="/tags/#界面设计" title="界面设计" rel="tag" date-size="2">
									界面设计
								</a>
							
						
							
						
					</div>
				</section>
				
=======

<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "rpsh";
    var disqus_identifier = "/posts/2014/04/30/div-flash";
    var disqus_url = "http://localhost:4000/posts/2014/04/30/div-flash/";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->


<!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="MTAyMC8zNzgwNS8xNDMzNg==">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 -->
            </div>
>>>>>>> origin/master

				<!-- Friends Blog -->
				
				<hr>
				<h5>FRIENDS</h5>
				<ul class="list-inline">
					
						<li><a href="http://rpsh.net/">任平生</a></li>
					
						<li><a href="http://itluantan.com/">IT乱谈</a></li>
					
				</ul>
				

				<!-- Search Page -->
				
				<hr>
				<h5><a href="/search/">Search</a></h5>
				<div class="search">
					
					<!-- 自定义搜索 -->
						<form class="search-form" action="/search/">
							<input type="search" name="q" class="search-input" placeholder="善用搜索..">
						</form>
					
				</div>
				
			</div>
		</div>
	</div>

</aside>


<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES * * */
	var disqus_shortname = "rpsh";
	var disqus_identifier = "/posts/2014/04/30/div-flash";
	var disqus_url = "http://localhost:4000/posts/2014/04/30/div-flash/";

	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
	function async(u, c) {
	  var d = document, t = 'script',
		  o = d.createElement(t),
		  s = d.getElementsByTagName(t)[0];
	  o.src = u;
	  if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
	  s.parentNode.insertBefore(o, s);
	}
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
	async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
		anchors.options = {
		  visible: 'always',
		  placement: 'right',
		  icon: '#'
		};
		anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
	})
</script>
<style>
	/* place left on bigger screen */
	@media all and (min-width: 800px) {
		.anchorjs-link{
			position: absolute;
			left: -0.75em;
			font-size: 1.1em;
			margin-top : -0.1em;
		}
	}
</style>



    <!-- Footer -->
<footer>
	<div class="container">
		<div class="row">
			<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
				<ul class="list-inline text-center">
					
					<li>
						<a href="http://feeds.rpsh.net/rpsh/note">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					
					
					<li>
						<a href="https://twitter.com/rpsh">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					

					<!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
					
					<li>
						<a target="_blank" href="https://www.zhihu.com/people/rpsh">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa  fa-stack-1x fa-inverse">知</i>
							</span>
						</a>
					</li>
					
					


					
					
					
                    <li>
                        <a target="_blank" href="https://instagram.com/rpsh">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    

					
					<li>
						<a target="_blank" href="https://github.com/rpsh">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-github fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					
				</ul>
				<p class="copyright text-muted">
					Copyright &copy; 任平生的学习笔记 2018
					<br>
					Theme by <a href="http://huangxuan.me">Hux</a>
				</p>
			</div>
		</div>
	</div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.min.js "></script>


<!-- async load function -->
<script>
	function async(u, c) {
	  var d = document, t = 'script',
		  o = d.createElement(t),
		  s = d.getElementsByTagName(t)[0];
	  o.src = u;
	  if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
	  s.parentNode.insertBefore(o, s);
	}
</script>

<!-- Highlight.js -->
<script>
	async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
		hljs.initHighlightingOnLoad();
	})
	// only load tagcloud.js in tag.html
	if($('#tag_cloud').length !== 0){
		async("/js/jquery.tagcloud.js",function(){
			$.fn.tagcloud.defaults = {
				//size: {start: 1, end: 1, unit: 'em'},
				color: {start: '#bbbbee', end: '#0085a1'},
			};
			$('#tag_cloud a').tagcloud();
		})
	}
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">

<!--fastClick.js -->
<script>
	async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
		var $nav = document.querySelector("nav");
		if($nav) FastClick.attach($nav);
	})
</script>



<!-- Google Analytics -->
<script>
	// dynamic User hacking by Hux
	// var _gaId = document.getElementById('gaId').value;
	var _gaId =  'UA-5528027-2';
	// var _gaDomain = document.getElementById('gaDomain').value;
	var _gaDomain = 'note.rpsh.net';

	// Originial
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', _gaId, _gaDomain);
	ga('send', 'pageview');
</script>





<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "WebSite",
	"url": "http://localhost:4000",
	"potentialAction": {
		"@type": "SearchAction",
		"target": "http://localhost:4000/search/?q={search_term_string}",
		"query-input": "required name=search_term_string"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Organization",
	"url": "http://localhost:4000 ",
	"logo": "http://localhost:4000/assets/common/favicon.png"
}
</script>
<script type="application/ld+json">
{
	"@context" : "http://schema.org",
	"@type" : "Person",
	"name" : "任平生",
	"url" : "",
	"sameAs" : [
		
		"http://twitter.com/rpsh",
		"http://instagram.com/rpsh",
		"http://www.linkedin.com/in/ihaiyang",
		"http://plus.google.com/100791036880126418228"
	]
}
</script>


<!-- Image to hack wechat -->
<img src="http://localhost:4000/assets/common/flash-thumb.jpg" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
